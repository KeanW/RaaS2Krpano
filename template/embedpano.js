/*
	krpano Embedding Script
	krpano 1.19-pr3 (build 2015-08-04)
*/
function createPanoViewer(e){function at(e){return(""+e).toLowerCase()}function ft(e,t){return e[d](t)>=0}function lt(){var t,r,i,s,o,u,a,f=n.location;f=f.search||f.hash;if(f){t=f[U](1)[I]("&");for(r=0;r<t[H];r++)i=t[r],s=i[d]("="),s==-1&&(s=i[H]),o=i[U](0,s),u=at(o),a=i[U](s+1),u==O?e[O]=a:u=="flash"?e.flash=a:u==g?e[g]=a:u==E?e[E]=a:u==x?e[x]=a:u[D](0,9)=="initvars."?(e[_]||(e[_]={}),e[_][o[D](9)]=a):e.addVariable(o,a)}}function ct(e){return e[j]=lt,e}function ht(){function x(){var e,n,i,s,o,u,a;if(t[st]){e=t[st]["Shockwave Flash"];if(typeof e=="object"){n=e.description;if(n){i=v,t[R]&&(s=t[R]["application/x-shockwave-flash"],s&&(s.enabledPlugin||(i=p)));if(i){o=n[I](" ");for(u=0;u<o[H];++u){a=parseFloat(o[u]);if(isNaN(a))continue;return a}}}}}if(r[et])try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(e){n=e.GetVariable("$version");if(n)return parseFloat(n[I](" ")[1][I](",").join("."))}}catch(f){}return 0}function T(){var e,t,i=p,s=n[k]("div");for(e=0;e<5;e++)if(typeof s.style[["p","msP","MozP","WebkitP","OP"][e]+"erspective"]!=V){i=v,e==3&&r.matchMedia&&(t=r.matchMedia("(-webkit-transform-3d)"),t&&(i=t.matches==v));break}return i}function N(){var e,t,r={failIfMajorPerformanceCaveat:v};try{e=n[k]("canvas");for(t=0;t<4;t++)if(e.getContext(["webgl","experimental-webgl","moz-webgl","webkit-3d"][t],r))return v}catch(i){}return p}var l,c,h,m,g,y,b,w,E,S;l=p,c=p,h=p;if(e.isDevice("iphone|ipad|ipod")&&i[d]("opera mini")<0)a=f=v;else{u=x(),u>=10.1&&(o=v),l=T(),c=N(),m=at(t.platform),g=0,y=0,b=0,w=i[d]("firefox/"),w<0&&(w=i[d]("gecko/")),w>=0&&(g=parseInt(i[D](1+i[d]("/",w)),10)),h=!!r[tt],w=i[d](tt),w>0&&(b=parseInt(i[D](w+7),10),h=v),w=i[d](rt),w>0&&(y=parseInt(i[D](w+8),10),g>=18&&(y=4)),l&&(y>0&&y<4&&(l=p),g>3&&g<18&&y>1&&(c=l=p),c||(m[d](nt)<0&&g>3&&y<1&&(l=p),b>9&&b<20&&(l=p)));if(l||c){a=v,E=i[d]("blackberry")>=0||i[d]("rim tablet")>=0||i[d]("bb10")>=0,S=(t.msMaxTouchPoints|0)>1;if(y>=4||E||S)f=v}}s=1|l<<1|c<<2|h<<3}function pt(e){function x(e){function a(){r[m]?(r[m]("DOMMouseScroll",c,p),r[m]("mousewheel",c,p),n[m]("mousedown",f,p),n[m]("mouseup",l,p)):(r.opera?r.attachEvent(B,c):r[B]=n[B]=c,n.onmousedown=f,n.onmouseup=l)}function f(e){e||(e=r.event,e[b]=e[Q]),u=e?e[b]:S}function l(e){var t,i,s,a,f,l,c,h;e||(e=r.event,e[b]=e[Q]),t=0,i=o[H];for(t=0;t<i;t++){s=o[t];if(s){a=n[s.id];if(a&&s.needfix){f=a.getBoundingClientRect(),l=a==e[b],c=a==u,h=e.clientX>=f.left&&e.clientX<f.right&&e.clientY>=f.top&&e.clientY<f.bottom;if((l||c)&&h==p)try{a[z]&&a[z](0,"mouseUp")}catch(d){}}}}return v}function c(t){var i,u,a,f,l,c;t||(t=r.event,t[b]=t[Q]),i=0,u=p,t.wheelDelta?(i=t.wheelDelta/120,r.opera&&s&&(i/=4/3)):t.detail&&(i=-t.detail,s==p&&(i/=3));if(i){a=0,f=o[H];for(a=0;a<f;a++){l=o[a];if(l){c=n[l.id];if(c&&c==t[b]){try{c.jswheel?c.jswheel(i):c[y]?c[y](i):c[A]&&(c[A](),c[y]&&c[y](i))}catch(h){}u=v;break}}}}e[G]==p&&(u=p);if(u)return t[it]&&t[it](),t[ot]&&t[ot](),t.cancelBubble=v,t.cancel=v,n[m]||(t.returnValue=p),p}var i,s=at(t.appVersion)[d](nt)>=0,o=r._krpMW,u=S;o||(o=r._krpMW=new Array,a()),i=e[g],o.push({id:e.id,needfix:s||!!r[tt]||i=="opaque"||i=="transparent"})}var i,s,o,u,a,f=encodeURIComponent,l="",c=e[Y],h=e[P],E=e.id;for(;;){s=n[N](E);if(!s)break;E+=String.fromCharCode(48+Math.floor(9*Math.random())),e.id=E}e[g]&&(h[g]=e[g]),e[C]&&(h[C]=e[C]),e[W]!==undefined&&(c[W]=e[W]),e[g]=at(h[g]),h.allowfullscreen="true",h.allowscriptaccess=F,i="browser.",l=i+"useragent="+f(t.userAgent)+"&"+i+"location="+f(r.location.href);for(i in c)l+="&"+f(i)+"="+f(c[i]);i=_,c=e[i];if(c){l+="&"+i+"=";for(i in c)l+="%26"+f(escape(i))+"="+f(escape(c[i]))}h.flashvars=l,e[L]&&(h.base=e[L]),o="",u=' id="'+E+'" width="'+e.width+'" height="'+e.height+'" style="outline:none;" ',a="_krpcb_"+E,!e[q]||(r[a]=function(){try{delete r[a]}catch(t){r[a]=S}e[q](n[N](E))});if(t[st]&&t[R]&&!r[et]){o='<embed name="'+E+'"'+u+'type="application/x-shockwave-flash" src="'+e.swf+'" ';for(i in h)o+=i+'="'+h[i]+'" ';o+=" />"}else{o="<object"+u+'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"><param name="movie" value="'+e.swf+'" />';for(i in h)o+='<param name="'+i+'" value="'+h[i]+'" />';o+="</object>"}e[w].innerHTML=o,x(e)}function dt(t){function i(e,t,r){var i,s=n.getElementsByTagName("head");s&&(s=s[0]),s||(s=n.body),s?(i=n[k]("script"),i.type="text/javascript",i.async=v,i.onload=t,i[T]=r,i.src=e,s.appendChild(i)):r()}function s(){return typeof embedpanoJS!==V}function o(){s()?(e[Y][W]=e[W],e[P]=e,e.htmltarget=e[b],embedpanoJS(t)):u()}function u(){t[T]("HTML5 Version not available!")}var r=t.js;r||(r=t.swf,r=r[D](0,r.toLowerCase().lastIndexOf(".swf")+1)+"js"),s()?o():i(r,o,u)}var t,n,r,i,s,o,u,a,f,l,c,h,p=!1,d="indexOf",v=!0,m="addEventListener",g="wmode",y="externalMouseEvent",b="target",w="targetelement",E="mobilescale",S=null,x="fakedevice",T="onerror",N="getElementById",C="bgcolor",k="createElement",L="flashbasepath",A="enable_mousewheel_js_bugfix",O="html5",M="never",_="initvars",D="slice",P="params",H="length",B="onmousewheel",j="passQueryParameters",F="always",I="split",q="onready",R="mimeTypes",U="substring",z="externalMouseEvent2",W="xml",X="only",V="undefined",$="prefer",J="basepath",K="useHTML5",Q="srcElement",G="mwheel",Y="vars",Z="consolelog",et="ActiveXObject",tt="chrome",nt="mac",rt="android",it="stopPropagation",st="plugins",ot="preventDefault",ut="fallback";return t=navigator,n=document,r=window,i=at(t.userAgent),s=0,o=p,u=0,a=p,f=p,e||(e={}),l=e[j]===v,e.swf||(e.swf="krpano.swf"),e.js||(e.js=S),e[W]===undefined&&(e[W]=e.swf[I](".swf").join(".xml")),e.id||(e.id="krpanoSWFObject"),e.width||(e.width="100%"),e.height||(e.height="100%"),e[C]||(e[C]="#000000"),e[g]||(e[g]=S),e[b]||(e[b]=S),e[O]||(e[O]="auto"),e[G]===undefined&&(e[G]=v),e[Y]||(e[Y]={}),e[P]||(e[P]={}),e[q]||(e[q]=S),e[E]||(e[E]=.5),e[x]||(e[x]=S),e[J]?e[L]=e[J]:(c="./",h=e.swf.lastIndexOf("/"),h>=0&&(c=e.swf[D](0,h+1)),e[J]=c),e.isDevice=function(e){var t,n,r,s="all",o=["ipad","iphone","ipod",rt];for(t=0;t<4;t++)i[d](o[t])>=0&&(s+="|"+o[t]);e=at(e)[I]("|");if(e==S)return v;n=e[H];for(t=0;t<n;t++){r=e[t];if(s[d](r)>=0)return v}return p},e.addVariable=function(t,n){t=at(t),t=="pano"||t==W?e[W]=n:e[Y][t]=n},e.addParam=function(t,n){e[P][at(t)]=n},e[K]!==undefined&&(e[O]=e[K]),e[K]=function(t){e[O]=t},e.isHTML5possible=function(){return s==0&&ht(),a},e.isFlashpossible=function(){return s==0&&ht(),o},e[T]||(e[T]=function(t){var n=e[w];n?n.innerHTML='<table width="100%" height="100%"><tr style="vertical-align:middle;"><td><center>ERROR:<br/><br/>'+t+"<br/><br/></center></td></tr></table>":alert("ERROR: "+t)}),e.embed=function(r){var c,h,m,y,E,x,C,k,L,A;r&&(e[b]=r),e[w]=n[N](e[b]),e[w]?(l&&lt(),e[G]==p&&(e[Y]["control.disablewheel"]=v),e[Z]&&(e[Y][Z]=e[Z]),s==0&&ht(),c=at(e[O]),h=e.flash,h&&(h=at(h),h==$?c=ut:h==ut?c=$:h==X?c=M:h==M&&(c=X)),m=o,y=a,E=a,E&&o&&s&8&&(n.domain==""||(s&4)==0)&&(E=p),c==M?y=p:ft(c,X)&&(m=p),ft(c,F)?(o=m=p,a=y=v):y&&(c=="whenpossible"||ft(c,$)&&E||ft(c,"auto")&&f)&&(m=p),m&&o?(u>=11.4&&(x=v,at(t.platform)[d](nt)>=0&&at(t.vendor)[d]("apple")>=0&&(C=i[d]("webkit/"),C>0&&(C=parseFloat(i[D](C+7)),!isNaN(C)&&C>0&&C<534&&(x=p))),x&&e[g]==S&&!e[P][g]&&(e[g]=s&8?"window":"direct")),pt(e)):y&&a?dt(e):(k="",L=c!=M,A=o==p&&(c==M||!ft(c,F)&&!ft(c,X)),A&&(k+="Adobe Flashplayer"),A&&L&&(k+=" or<br/>"),L&&(k+="HTML5 Browser with CSS3D or WebGL support"),k+=" required!",e[T](k))):e[T]("No Embedding Target")},ct(e)}function removepano(e){var t,n,r,i,s=document.getElementById(e);if(s){t=window._krpMW;if(t)for(n=0;n<t.length;n++){r=t[n];if(r&&r.id===e){t.splice(n,1);break}}s.unload&&s.unload(),i=s.parentNode,i&&i.removeChild(s)}}function embedpano(e){createPanoViewer(e).embed()};
